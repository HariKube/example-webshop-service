apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: cert-manager
spec:
  timeouts:
    assert: 5m
  namespace: default
  skipDelete: true
  steps:
  - name: Deploy cert-manager
    try:
    - apply:
        file: https://github.com/cert-manager/cert-manager/releases/download/v1.16.3/cert-manager.yaml
    - assert:
        resource:
          apiVersion: apps/v1
          kind: Deployment
          metadata:
            name: cert-manager
            namespace: cert-manager
          status:
            availableReplicas: 1
    - assert:
        resource:
          apiVersion: apps/v1
          kind: Deployment
          metadata:
            name: cert-manager-webhook
            namespace: cert-manager
          status:
            availableReplicas: 1
    - assert:
        resource:
          apiVersion: apps/v1
          kind: Deployment
          metadata:
            name: cert-manager-cainjector
            namespace: cert-manager
          status:
            availableReplicas: 1